<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Liste des commandes</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 30px;
    }

    .logo {
        position: absolute;
        top: 15px;
        right: 15px;
        width: 80px;
        height: auto;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 30px;
    }
    th, td {
        border: 1px solid black;
        padding: 8px;
        text-align: center;
    }
</style>
</head>
<body>

<img src="logo.png" class="logo">

<h1>Liste des commandes</h1>

<table>
    <thead>
        <tr>
            <th>Prénom</th>
            <th>Nom</th>
            <th>Adresse</th>
            <th>Heure</th>
            <th>Viennoiserie</th>
            <th>Céréale</th>
            <th>Boisson</th>
        </tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>

<h2>Totaux</h2>
<ul id="totaux"></ul>

<script>
// --- Paramètres GitHub ---
const GITHUB_USER = "TON_USERNAME";      // <-- remplace par ton nom d'utilisateur GitHub
const GITHUB_REPO = "TON_REPO";          // <-- remplace par ton dépôt
const GITHUB_FILE = "commandes.json";    // fichier où sont stockées les commandes

async function chargerCommandes() {
    try {
        let res = await fetch(`https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${GITHUB_FILE}`);
        if (!res.ok) throw new Error("Impossible de récupérer les commandes");
        let data = await res.json();

        // Le contenu est encodé en base64
        let commandes = JSON.parse(atob(data.content));

        // Tri par heure
        commandes.sort((a, b) => a.heure.localeCompare(b.heure));

        let body = document.getElementById("tableBody");

        let total = {
            "Croissant": 0,
            "Pain au chocolat": 0,
            "Muesli": 0,
            "Trésor": 0,
            "Lait": 0,
            "Jus d'orange": 0,
            "Jus de pomme": 0
        };

        commandes.forEach(c => {
            let row = document.createElement("tr");
            row.innerHTML = `
                <td>${c.prenom}</td>
                <td>${c.nom}</td>
                <td>${c.adresse}</td>
                <td>${c.heure}</td>
                <td>${c.viennoiserie}</td>
                <td>${c.cereales}</td>
                <td>${c.boisson}</td>
            `;

            if (c.viennoiserie in total) total[c.viennoiserie]++;
            if (c.cereales in total) total[c.cereales]++;
            if (c.boisson in total) total[c.boisson]++;

            body.appendChild(row);
        });

        let totaux = document.getElementById("totaux");
        for (let item in total) {
            let li = document.createElement("li");
            li.textContent = item + " : " + total[item];
            totaux.appendChild(li);
        }

    } catch (err) {
        console.error(err);
        alert("Erreur lors du chargement des commandes depuis GitHub.");
    }
}

// Charger les commandes au démarrage
chargerCommandes();
</script>

</body>
</html>
