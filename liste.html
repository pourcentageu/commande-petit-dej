<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Liste des commandes – Sh'Artlock Holmes</title>

<style>
    body {
        font-family: "Georgia", serif;
        background-image: url('https://images.unsplash.com/photo-1529070538774-1843cb3265df?auto=format&fit=crop&w=1600&q=80');
        background-size: cover;
        background-attachment: fixed;
        background-position: center;
        margin: 0;
        padding: 0;
        color: #222;
    }

    header {
        width: 100%;
        background: rgba(0,0,0,0.6);
        padding: 20px;
        text-align: center;
        color: white;
        font-size: 32px;
        position: relative;
        letter-spacing: 2px;
    }

    #logo {
        position: absolute;
        top: 5px;
        right: 10px;
        width: 110px;
    }

    table {
        width: 95%;
        margin: 40px auto;
        border-collapse: collapse;
        background: rgba(255,255,255,0.9);
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }

    th, td {
        border: 1px solid #555;
        padding: 10px;
        text-align: center;
    }

    th {
        background: #3b2f2f;
        color: white;
        font-size: 18px;
    }

    h2 {
        text-align: center;
        color: white;
        text-shadow: 0 0 10px black;
    }

    #totaux {
        width: 60%;
        margin: 20px auto;
        background: rgba(255,255,255,0.95);
        padding: 20px;
        border-radius: 10px;
        font-size: 18px;
        box-shadow: 0 0 15px rgba(0,0,0,0.4);
    }

</style>
</head>

<body>

<header>
    Liste des commandes  
    <img id="logo" src="https://pourcentageu.github.io/commande-petit-dej/logo.png">
</header>

<h2>Commandes classées par heure</h2>

<table id="table">
    <thead>
        <tr>
            <th>Nom</th>
            <th>Prénom</th>
            <th>Adresse</th>
            <th>Heure</th>

            <th>Croissant</th><th>Qté</th>
            <th>Pain Choco</th><th>Qté</th>
            <th>Céréales</th><th>Qté</th>
            <th>Lait</th><th>Qté</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<div id="totaux"></div>

<script>
// -----------------------
// FONCTIONS ANTI-UNDEFINED
// -----------------------
function safeItem(cat) {
    return cat && cat.item ? cat.item : "";
}
function safeQty(cat) {
    return cat && typeof cat.qty !== "undefined" ? cat.qty : 0;
}

// -----------------------
// CHARGER LES COMMANDES
// -----------------------
let commandes = JSON.parse(localStorage.getItem("commandes") || "[]");

// tri par heure croissante
commandes.sort((a, b) => {
    return a.heure.localeCompare(b.heure);
});

let tbody = document.querySelector("tbody");

// totaux
let totalCroissant = 0;
let totalPainChoco = 0;
let totalCereales = 0;
let totalLait = 0;

// -----------------------
// AFFICHAGE DES COMMANDES
// -----------------------
commandes.forEach(entry => {

    totalCroissant += safeQty(entry.croissant);
    totalPainChoco += safeQty(entry.painchoco);
    totalCereales += safeQty(entry.cereales);
    totalLait += safeQty(entry.lait);

    let tr = document.createElement("tr");

    tr.innerHTML = `
        <td>${entry.nom}</td>
        <td>${entry.prenom}</td>
        <td>${entry.adresse}</td>
        <td>${entry.heure}</td>

        <td>${safeItem(entry.croissant)}</td>
        <td>${safeQty(entry.croissant)}</td>

        <td>${safeItem(entry.painchoco)}</td>
        <td>${safeQty(entry.painchoco)}</td>

        <td>${safeItem(entry.cereales)}</td>
        <td>${safeQty(entry.cereales)}</td>

        <td>${safeItem(entry.lait)}</td>
        <td>${safeQty(entry.lait)}</td>
    `;

    tbody.appendChild(tr);
});

// -----------------------
// AFFICHAGE DES TOTAUX
// -----------------------
document.getElementById("totaux").innerHTML = `
    <h3>Totaux :</h3>
    <p><b>Croissants :</b> ${totalCroissant}</p>
    <p><b>Pains au chocolat :</b> ${totalPainChoco}</p>
    <p><b>Céréales :</b> ${totalCereales}</p>
    <p><b>Lait :</b> ${totalLait}</p>
`;
</script>

</body>
</html>
